<!DOCTYPE html>
<html lang="ua">
<head>
    <%- include('base/head'); %>
    <title>Трансляція</title>
    <meta name="description" content="Educational manager course video translation"/>
    <link rel="stylesheet" typDe="text/css" href="/styles/css/course-translation.css">

    <script src="/scripts/js/socket-events.js"></script>
    <script src="/scripts/js/video-broadcast.js"></script>
</head>
<body>
<div class="footer-push row">
    <header class="row main-header">
        <%- include('base/menu', {active: 1}); %>
    </header>
    <main class="row container translation">
        <section class="control-buttons">
            <button id="broadcast" class="btn-primary">Broadcast</button>
            <button id="stop" class="btn-danger">Stop Broadcast</button>
            <button id="capture" class="btn-primary">Capture</button>
            <button id="stopPlayback" class="btn-danger">Stop Capture</button>
        </section>
        <video id="recording-video" class="recording-video" style="display: none"></video>
        <img id="frames-container" class="frames-container" hidden>
    </main>
</div>
<%- include('base/footer'); %>
<script>
    var recordingVideo = document.querySelector('#recording-video'),
        framesContainer = document.querySelector('#frames-container');

    var videoBroadcast = new VideoBroadcast({
        url: location.origin.replace(/^http/, 'ws'),
        videoElement: recordingVideo,
        imageElement: framesContainer,
        height: 360,
        fps: 24,
        room: <%= courseId %>
    });

    document.getElementById('broadcast').onclick = function() {
        videoBroadcast.start(function() {
            recordingVideo.style.display = '';
        });
    };
    document.getElementById('stop').onclick = function() {
        videoBroadcast.stop();
        recordingVideo.style.display = 'none';
    };
    document.getElementById('capture').onclick = function() {
        videoBroadcast.subscribe();
        framesContainer.hidden = false;
    };
    document.getElementById('stopPlayback').onclick = function() {
        videoBroadcast.stopPlayback();
        framesContainer.hidden = true;
    };
</script>
</body>
</html>